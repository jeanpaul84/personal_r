CREATE TABLE DIM_DISTRIBUTOR (
    DIST_DIM_ID         NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DISTRIBUTOR_NAME    VARCHAR2(255),
    CITY                VARCHAR2(100),
    STATE               VARCHAR2(100),
    REGION              VARCHAR2(100),
    DISTRIBUTOR_ID      NUMBER -- La llave del sistema original
);


INSERT INTO DIM_DISTRIBUTOR (DISTRIBUTOR_NAME, CITY, STATE, REGION, DISTRIBUTOR_ID)
SELECT
  cd.COMPANY_NAME,
  cd.CITY,
  cd.STATE,
  cdr.REGION,
  cd.ID -- La llave original del distribuidor
FROM
  CAR_DISTRIBUTORS cd
JOIN
  CAR_DIST_REGION cdr ON cd.STATE = cdr.STATE;


SELECT * FROM DIM_DISTRIBUTOR;


SELECT * FROM CAR_DISTRIBUTORS WHERE ID = 51;

COMMIT;