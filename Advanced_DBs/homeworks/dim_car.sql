CREATE TABLE DIM_CAR (
    CAR_DIM_ID          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    MAKE                VARCHAR2(100),
    MODEL               VARCHAR2(100),
    YEAR                NUMBER(4),
    MARKET_CATEGORY     VARCHAR2(100),
    TARGET_MARKET       VARCHAR2(50),
    VEHICLE_STYLE       VARCHAR2(50),
    VEHICLE_SIZE        VARCHAR2(50),
    DRIVEN_WHEELS       VARCHAR2(50),
    NUMBER_OF_DOORS     VARCHAR2(10),
    FUEL_TYPE           VARCHAR2(50),
    TRANSMISSION_TYPE   VARCHAR2(50),
    RETAIL_PRICE        NUMBER,
    CAR_ID              NUMBER -- La llave del sistema original
);

INSERT INTO DIM_CAR (
    MAKE, MODEL, YEAR, MARKET_CATEGORY, TARGET_MARKET,
    VEHICLE_STYLE, VEHICLE_SIZE, DRIVEN_WHEELS, NUMBER_OF_DOORS,
    FUEL_TYPE, TRANSMISSION_TYPE, RETAIL_PRICE, CAR_ID
)
SELECT
    MAKE, MODEL, YEAR, MARKET_CATEGORY, TARGET_MARKET,
    VEHICLE_STYLE, VEHICLE_SIZE, DRIVEN_WHEELS, NUMBER_OF_DOORS_N, 
    FUEL_TYPE, TRANSMISSION_TYPE, RETAIL_PRICE, ID 
FROM
    CARS;

SELECT * FROM DIM_CAR;

SELECT COUNT(*) FROM CARS;
SELECT COUNT(*) FROM DIM_CAR;

COMMIT;