CREATE TABLE DIM_TIME (
    TIME_ID           NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    MONTH_NAME        VARCHAR2(20),
    MONTH_NUMBER      NUMBER(2),
    QUARTER_NAME      VARCHAR2(10),
    QUARTER_NUMBER    NUMBER(1),
    YEAR              NUMBER(4)
);

INSERT INTO DIM_TIME (MONTH_NAME, MONTH_NUMBER, QUARTER_NAME, QUARTER_NUMBER, YEAR)
WITH MONTHS_IN_DATA AS (
  SELECT DISTINCT
    TRUNC(SELL_DATE, 'MM') AS MONTH_START_DATE
  FROM
    SELL_ORDERS_DATA
)
SELECT
  TO_CHAR(MONTH_START_DATE, 'Month') AS MONTH_NAME, -- Nombre del mes 
  EXTRACT(MONTH FROM MONTH_START_DATE) AS MONTH_NUMBER,
  'Q' || TO_CHAR(MONTH_START_DATE, 'Q') AS QUARTER_NAME, -- El formato 'Q' trimestre
  TO_NUMBER(TO_CHAR(MONTH_START_DATE, 'Q')) AS QUARTER_NUMBER,
  EXTRACT(YEAR FROM MONTH_START_DATE) AS YEAR
FROM
  MONTHS_IN_DATA
ORDER BY
  MONTH_START_DATE;


SELECT * FROM DIM_TIME;

COMMIT;